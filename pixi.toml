[workspace]
authors = ["ian <ian.page38@gmail.com>"]
channels = ["conda-forge", "pytorch", "nvidia"]
name = "workspace"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]
download-weights = "bash pixi_scripts/download_weights.sh"
build-glomap = "bash pixi_scripts/build_glomap.sh"
post-install = { depends-on = ["build-glomap", "download-weights"] }

[dependencies]
python = "3.10.*"
cmake = ">=3.28"
ninja = ">=1.11"
make = ">=4.3"
cxx-compiler = ">=1.5"
cuda-nvcc = "12.1.*"
cuda-version = "12.1"
colmap = ">=3.9"
ceres-solver = ">=2.1"
eigen = ">=3.4"
boost = ">=1.82"
glog = ">=0.6"
gflags = ">=2.2"
suitesparse = ">=5.10"
opencv = ">=4.8"
ffmpeg = ">=6.0"
numpy = "<2.0"
h5py = ">=3.8"
trimesh = ">=4.0"
# pycolmap moved to pypi
open3d = ">=0.18"
pillow = ">=10.0"
requests = ">=2.31"
pyopengl = ">=3.1"
huggingface_hub = ">=0.19"
pytorch = { version = ">=2.1.0", channel = "pytorch" }
torchvision = { version = ">=0.16.0", channel = "pytorch" }
# pytorch-cuda = { version = "12.1", channel = "pytorch" } # Let pytorch dependency resolve this
# Force nvidia channel for cuda libs to satisfy pytorch-cuda's internal deps
cuda-libraries = { version = "12.1.*", channel = "nvidia" }
libcublas = { version = "*", channel = "nvidia" }
libcufft = { version = "*", channel = "nvidia" }
libcusolver = { version = "*", channel = "nvidia" }
libcusparse = { version = "*", channel = "nvidia" }
libnvjpeg = { version = "*", channel = "nvidia" }
libnpp = { version = "*", channel = "nvidia" }
libgl-devel = ">=1.7.0,<2"
libglu = ">=9.0.3,<10"
cgal = ">=5.6.1,<6"
libcurand-dev = ">=10.3.2.106,<11"

[pypi-dependencies]
dual-quaternions = ">=0.4.0, <0.5"
plyfile = ">=1.1.3, <2"
piexif = ">=1.1.3, <2"
pillow-heif = ">=1.1.1, <2"
hloc = { git = "https://github.com/cvg/Hierarchical-Localization.git" }
lightglue = { git = "https://github.com/cvg/LightGlue.git" }
pycolmap = ">=0.6"
